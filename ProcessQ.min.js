(function(b,f){var c=b.ProcessQ=function(g){for(var h in g){this[h]=g[h]}var i=this;this.callRun=function(){i.run()};this.timer={}};c.types={};c.prototype={constructor:c,interval:20,ignorError:true,defaultDelay:0,defaultItemIsFinished:function(){return true},init:function(){this.resultPool={};var h=this.items||[];this.items=[];this.itemCount=0;this.totalWeight=0;for(var j=0,g=h.length;j<g;j++){var k=h[j];this.addItem(k)}if(this.onInit!=null){this.onInit()}},onInit:null,addItem:function(g){if(!g.id){g.id="id_"+(this.items.length+1)}if(g.type){g=new c.types[g.type](g)}g.delay=isNaN(g.delay)?this.defaultDelay:Number(g.delay);g.weight=isNaN(g.weight)||g.weight===0?1:Number(g.weight);g.isFinished=g.isFinished||this.defaultItemIsFinished;this.totalWeight+=g.weight;this.items.push(g);this.itemCount++},start:function(){this.paused=false;this.itemIndex=0;this.finishedWeight=0;this.finishedCount=0;this.timerStart();this.activeItem(0);this.run()},timerStart:function(){var g=this.timer;g.current=Date.now();g.start=g.last=g.current;g.delta=0;g.duration=0},timerTick:function(){var g=this.timer;g.last=g.current;g.current=Date.now();g.delta=g.current-g.last;g.duration+=g.delta},run:function(){this.mainLoop=setTimeout(this.callRun,this.interval);this.timerTick();var g=this.timer.delta;if(this.paused&&this.onPausing!=null){this.onPausing(g);return}if(!this.currentItem){this.finish();return}this.update(g)},finish:function(){clearTimeout(this.mainLoop);if(this.onFinish!=null){this.onFinish(this)}},onFinish:null,next:function(g){this.activeItem(++this.itemIndex)},getItem:function(g){return this.items[g]},activeItem:function(g){this.itemIndex=g;this.currentItem=this.getItem(g);if(this.currentItem){this.currentItem._delay=this.currentItem.delay;if(this.currentItem._delay==0){this.currentItem.start(this);this.currentItem._started=true}}},update:function(g){if(g<1){return}if(this.currentItem._delay>=this.interval){this.currentItem._delay-=g}else{if(!this.currentItem._started){this.currentItem.start(this);this.currentItem._started=true}}if(this.currentItem._started){if(this.currentItem.isFinished(this)){this.onItemFinish(this.currentItem);this.finishedWeight+=this.currentItem.weight;this.next(g)}else{if(this.currentItem.isError&&this.currentItem.isError(this)){this.onItemError(this.currentItem,this);if(this.ignorError){this.finishedWeight+=this.currentItem.weight;this.next(g)}}}}if(this.currentItem){if(this.currentItem.onProgressing){this.currentItem.onProgressing(g,this)}}this.onProgressing(g,this)},onItemFinish:function(i,g){if(i.onFinish){i.onFinish(g)}if(i.getResult){var h=i.getResult();this.resultPool[i.id]=h}this.finishedCount++},onItemError:function(h,g){if(h.onError){h.onError(h.errorEvent,g)}h.errorEvent=null},onProgressing:function(h,g){}};var a=function(g){for(var h in g){this[h]=g[h]}};c.types.img=a;a.prototype={async:false,constructor:a,id:null,start:function(h){var i=this.img=new Image();this.finished=this.async;var k=this;function j(l){k.finished=true;this.removeEventListener("load",j)}function g(l){k.finished=false;k.errorEvent=l;this.removeEventListener("error",g)}i.addEventListener("load",j);i.addEventListener("error",g);i.src=this.src},getResult:function(){return this.img},onFinish:function(g){},isFinished:function(g){return this.finished},isError:function(g){return this.errorEvent}};var e=function(g){for(var h in g){this[h]=g[h]}};e.formats={mp3:"audio/mpeg",ogg:"audio/ogg; codecs=vorbis",};c.types.audio=e;(function(){var h=new Audio();for(var g in e.formats){if(h.canPlayType(e.formats[g])){e.supportFormat=g;break}}}());e.prototype={constructor:e,id:null,async:false,start:function(h){var i=this.audio=new Audio();this.finished=this.async;var k=this;function j(l){k.finished=true;this.removeEventListener("canplaythrough",j)}function g(l){k.finished=false;k.errorEvent=l;this.removeEventListener("error",g)}i.addEventListener("canplaythrough",j);i.addEventListener("error",g);i.src=this.src+"."+e.supportFormat;i.preload=true;i.autobuffer=true;i.load()},getResult:function(){return this.audio},isFinished:function(g){return this.finished},isError:function(g){return this.errorEvent}};var d=function(g){for(var h in g){this[h]=g[h]}};c.types.script=d;d.prototype={constructor:d,id:null,async:false,start:function(h){var i=this.script=new Image();this.finished=this.async;var k=this;function j(l){k.finished=true;this.removeEventListener("load",j)}function g(l){k.finished=false;k.errorEvent=l;this.removeEventListener("error",g)}i.addEventListener("load",j);i.addEventListener("error",g);i.setAttribute("src",this.src);setTimeout(function(){var m=document.getElementsByTagName("HEAD").item(0);var l=document.createElement("script");l.type="text/javascript";l.src=i.src;m.appendChild(l)},10)},getResult:function(){return this.script},isFinished:function(g){return this.finished},isError:function(g){return this.errorEvent}}}(this));